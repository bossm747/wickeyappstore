<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Custom WAS Test Page</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="src/favicon.ico">

  <!-- WickeyAppStore CSS -->
  <link rel="stylesheet" href="elements/styles.css">
</head>

<body>
  <wickey-appstore></wickey-appstore>
  <script type="text/javascript" src="elements/wickeyappstore.js"></script>

  <script>
    const wickeyappstore = document.querySelector('wickey-appstore');
    wickeyappstore.addEventListener('open', (event) => {
      console.log('WAS button opened');  // can pause game here.
    });
    window.WAS.userService.user.subscribe(usr => {
      console.log('userServiceOut user.subscribe', usr);
    });
    // Check if purchased (where 10 is your purchase item id).
    window.WAS.userService.checkIfPurchased(10).subscribe(isPurch => {
      console.log('checkIfPurchased', isPurch);
    });
    // Example of how to pass in own save conflict mapping function.
    // Default mapping will choose the newest save.
    function onSaveConflict(localSave, cloudSave) {
      let keepSave = localSave;
      if (localSave && cloudSave) {
        if (cloudSave.highScore > localSave.highScore) {
          keepSave = cloudSave;
        }
      }
      return keepSave;
    }
    window.WAS.dataService.restore(onSaveConflict).subscribe(mydata => {
      console.log('wasDataService.restore', mydata);
      // WasDataService is now loaded and restored (ready for use).
      // window.WAS.dataService.get('highScore');
      // window.WAS.dataService.save('highScore', 3000);
      // Then after the session (or game level), persist to cloud
      // window.WAS.dataService.persist();
    });
  </script>
</body>

</html>
